# Docker Troubleshooting Guide

## ุงููุดููุฉ: ุงููููุฐุฌ ูุง ูุชู ุชุญูููู ูู Docker

### ๐ **ุชุดุฎูุต ุงููุดููุฉ:**

#### 1. **ูุญุต ุงูุณุฌูุงุช (Logs)**
```bash
# ุนุฑุถ ุณุฌูุงุช ุงูุญุงููุฉ
docker logs <container_name>

# ูุชุงุจุนุฉ ุงูุณุฌูุงุช ูู ุงูููุช ุงููุนูู
docker logs -f <container_name>
```

#### 2. **ูุญุต ุญุงูุฉ ุงููููุฐุฌ**
```bash
# ูุญุต ุญุงูุฉ ุงููููุฐุฌ
curl http://localhost:8080/model-status

# ูุญุต ุงูุตุญุฉ ุงูุนุงูุฉ
curl http://localhost:8080/health
```

#### 3. **ูุญุต ูุญุชููุงุช ุงูุญุงููุฉ**
```bash
# ุงูุฏุฎูู ุฅูู ุงูุญุงููุฉ
docker exec -it <container_name> /bin/bash

# ูุญุต ุงููููุงุช
ls -la /app/
ls -la /app/ssd_mobilenet_v1_coco_11_06_2017/
```

### ๐๏ธ **ุงูุญููู ุงููุทุจูุฉ:**

#### 1. **ุชุญุณูู Dockerfile**
- โ ุฅุถุงูุฉ ุฃุฏูุงุช ุฅุถุงููุฉ (wget, tar)
- โ ุฅูุดุงุก ูุฌูุฏุงุช ุงูููุงุฐุฌ ูุน ุงูุตูุงุญูุงุช ุงูุตุญูุญุฉ
- โ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุญุณูุฉ ูู TensorFlow
- โ Health check ููุชุญูู ูู ุงูุญุงูุฉ
- โ ุฅุนุฏุงุฏุงุช ุงูุฐุงูุฑุฉ ุงููุญุณูุฉ

#### 2. **ุชุญุณูู main.py**
- โ ูุดู ุงูุจูุฆุฉ (Docker vs Local)
- โ ููุช ุงูุชุธุงุฑ ุฃุทูู ูู Docker
- โ ุชุณุฌูู ููุตู ูููุณุงุฑุงุช ูุงููููุงุช
- โ ุงูุชุญูู ูู ูุฌูุฏ ูููุงุช ุงููููุฐุฌ
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

#### 3. **ูููุงุช ูุณุงุนุฏุฉ ุฌุฏูุฏุฉ**
- โ `.dockerignore` - ุงุณุชุจุนุงุฏ ุงููููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ
- โ `docker-compose.yml` - ุชูููู ุณูู ููุงุฎุชุจุงุฑ
- โ `build-and-test.ps1` - ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุชููุงุฆู

### ๐ **ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:**

#### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู Docker Compose
```bash
# ุจูุงุก ูุชุดุบูู
docker-compose up --build

# ูู ูุงูุฐุฉ ูููุตูุฉ - ุงุฎุชุจุงุฑ API
curl http://localhost:8080/health
```

#### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู ุงูุณูุฑูุจุช
```powershell
# ุชุดุบูู ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ
.\build-and-test.ps1
```

#### ุงูุทุฑููุฉ 3: ูุฏููุงู
```bash
# ุจูุงุก ุงูุตูุฑุฉ
docker build -t traffic-light-detection .

# ุชุดุบูู ุงูุญุงููุฉ
docker run -d \
  --name traffic-light-test \
  -p 8080:8080 \
  -v "$(pwd)/test_images:/app/test_images:ro" \
  traffic-light-detection

# ูุญุต ุงูุณุฌูุงุช
docker logs traffic-light-test

# ุงุฎุชุจุงุฑ API
curl http://localhost:8080/model-status
```

### ๐ง **ุญููู ุงููุดุงูู ุงูุดุงุฆุนุฉ:**

#### 1. **ูุดููุฉ: "Model not loaded yet"**
**ุงูุณุจุจ:** ุงููููุฐุฌ ูู ูุชู ุชุญูููู ุจุนุฏ
**ุงูุญู:**
```bash
# ุงูุชุธุฑ ุฃูุซุฑ (ูุฏ ูุณุชุบุฑู 2-5 ุฏูุงุฆู)
sleep 60
curl http://localhost:8080/model-status

# ุฃู ุฃุนุฏ ุชุญููู ุงููููุฐุฌ ูุฏููุงู
curl -X POST http://localhost:8080/reload-model
```

#### 2. **ูุดููุฉ: "Connection refused"**
**ุงูุณุจุจ:** ุงูุญุงููุฉ ูู ุชุจุฏุฃ ุจุนุฏ
**ุงูุญู:**
```bash
# ุชุญูู ูู ุญุงูุฉ ุงูุญุงููุฉ
docker ps

# ุฅุฐุง ูู ุชูู ุชุนููุ ุงุจุฏุฃูุง
docker start <container_name>

# ุฃู ุฃุนุฏ ุชุดุบูููุง
docker restart <container_name>
```

#### 3. **ูุดููุฉ: "Permission denied"**
**ุงูุณุจุจ:** ูุดุงูู ูู ุงูุตูุงุญูุงุช
**ุงูุญู:**
```bash
# ุฅุนุงุฏุฉ ุจูุงุก ุงูุตูุฑุฉ ูุน ุงูุตูุงุญูุงุช ุงูุตุญูุญุฉ
docker build --no-cache -t traffic-light-detection .

# ุฃู ุชุดุบูู ูุน ุตูุงุญูุงุช root
docker run --user root -p 8080:8080 traffic-light-detection
```

#### 4. **ูุดููุฉ: "Out of memory"**
**ุงูุณุจุจ:** ุนุฏู ููุงูุฉ ุงูุฐุงูุฑุฉ
**ุงูุญู:**
```bash
# ุชุดุบูู ูุน ุฐุงูุฑุฉ ุฃูุซุฑ
docker run -m 4g -p 8080:8080 traffic-light-detection

# ุฃู ุงุณุชุฎุฏุงู Docker Compose ูุน ุฅุนุฏุงุฏุงุช ุงูุฐุงูุฑุฉ
```

### ๐ **ูุฑุงูุจุฉ ุงูุฃุฏุงุก:**

#### 1. **ุงุณุชุฎุฏุงู ุงูููุงุฑุฏ**
```bash
# ูุฑุงูุจุฉ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูุงููุนุงูุฌ
docker stats <container_name>
```

#### 2. **ูุญุต ุงูุณุฌูุงุช**
```bash
# ุงูุจุญุซ ุนู ุฃุฎุทุงุก ูุญุฏุฏุฉ
docker logs <container_name> 2>&1 | grep -i error
docker logs <container_name> 2>&1 | grep -i "model"
```

#### 3. **ุงุฎุชุจุงุฑ ุดุงูู**
```bash
# ุงุฎุชุจุงุฑ ุฌููุน endpoints
curl http://localhost:8080/
curl http://localhost:8080/health
curl http://localhost:8080/model-status
curl http://localhost:8080/docs
```

### ๐ฏ **ูุตุงุฆุญ ููุฃุฏุงุก ุงูุฃูุซู:**

1. **ุงุณุชุฎุฏู Docker Compose** ููุงุฎุชุจุงุฑ ุงููุญูู
2. **ุฑุงูุจ ุงูุณุฌูุงุช** ุจุงุณุชูุฑุงุฑ ุฃุซูุงุก ุงูุชุทููุฑ
3. **ุงุณุชุฎุฏู Health Checks** ููุชุญูู ูู ุงูุญุงูุฉ
4. **ุงุฎุชุจุฑ ูุน ุตูุฑ ุญููููุฉ** ููุชุฃูุฏ ูู ุนูู ุงููุดู
5. **ุงุณุชุฎุฏู Volume mounts** ููุตูุฑ ูุงููุชุงุฆุฌ

### ๐จ **ูุคุดุฑุงุช ุงููุดุงูู:**

| ุงููุคุดุฑ | ุงููุดููุฉ ุงููุญุชููุฉ | ุงูุญู |
|--------|------------------|------|
| `model_loaded: false` | ุงููููุฐุฌ ูู ูุชู ุชุญูููู | ุงูุชุธุฑ ุฃู ุฃุนุฏ ุงูุชุญููู |
| `Connection refused` | ุงูุญุงููุฉ ูุง ุชุนูู | ุฃุนุฏ ุชุดุบูู ุงูุญุงููุฉ |
| `Permission denied` | ูุดุงูู ุตูุงุญูุงุช | ุฅุนุงุฏุฉ ุจูุงุก ูุน ุตูุงุญูุงุช ุตุญูุญุฉ |
| `Out of memory` | ุฐุงูุฑุฉ ุบูุฑ ูุงููุฉ | ุฒูุงุฏุฉ ุญุฏ ุงูุฐุงูุฑุฉ |
| `Download failed` | ูุดููุฉ ุดุจูุฉ | ุชุญูู ูู ุงูุงุชุตุงู |

### โ **ุงูุชุญูู ูู ุงููุฌุงุญ:**

ุนูุฏูุง ูุนูู ูู ุดูุก ุจุดูู ุตุญูุญุ ูุฌุจ ุฃู ุชุฑู:
```json
{
  "model_loaded": true,
  "model_error": null,
  "status": "ready",
  "message": "Model is ready for inference"
}
```

ูุงุฎุชุจุงุฑ ุงููุดู ูุฌุจ ุฃู ูุนุทู ูุชูุฌุฉ ูุซู:
```json
{
  "command": "Stop",
  "confidence": 0.6875222325325012,
  "traffic_light_detected": true,
  "message": "Traffic light detected: Stop command"
}
```